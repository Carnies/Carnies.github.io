---
layout: default
title:  "PenTesting-Tools"
date:   2022-04-11
---

### PenTesting Tools

#### NMAP

- Introduction: port scanning technique used to know which services are running on the target
- Scan types:
  - TCP Connect Scans `-sT`
    - open: SYN/ACK
    - closed: RST
    - filtered as protected by firewall: packtes dropped and heard nothing back; or spoofed with RST response
  - SYN "Half-open" Scans `-sS`: reply RST to SYN/ACK
    - default scan of Nmap if run with sudo permissions
    - pro: bypass olrder IDS; faster than a connect scann; oftne not logged by application as connection not fully established
    - con: require sudo permission; cause problems to unstable services
  - UDP Scans `-sU`
    - open|filtered: no response
    - closed: ICMP packket stating that the port is unreachable
    - recommended to run with `-sU --top-ports <number>`
  - TCP Null Scans `-sN`
  - TCP FIN Scans `-sF`
  - TCP Xmas Scans `-sX`
    - all above three expects RST response for closed ports
  - ICMP network scan `-sn`: check active hosts' ip addresses
    - `nmap -sn 192.168.0.1-254` or `nmap -sn 192.168.0.0/24`
- Nmap Scripting Engine (NSE)
  - `--script=<category name or script-name>`
  - multiple scripts can be run simultaneously by separating by a comma
  - `--script <script-name> --script-args <script-name>.<argument1>,<script-name>.<argument2>`
- Firewall Evasion:
  - `Pn`: not pinging the hosts but to already treat the target hosts as being alive

#### Burp Suite

- Install: https://portswigger.net/burp/documentation/desktop/getting-started
- Sections:
  - Proxy - What allows us to funnel traffic through Burp Suite for further analysis
  - Target - How we set the scope of our project. We can also use this to effectively create a site map of the application we are testing. (**saw some bug bounty program will provide target file, specifying what domains should be included and what excluded**)
  - Intruder - Incredibly powerful tool for everything from field fuzzing to credential stuffing and more
    - Sniper - The most popular attack type, this cycles through our selected positions, putting the next available payload (item from our wordlist) in each position in turn. This uses only one set of payloads (one wordlist).
    - Battering Ram - Similar to Sniper, uses only one set of payloads. Unlike Sniper, Battering Ram puts every payload into every selected position. 
    - Pitchfork - multiple payload sets (one per position selected) and iterate through both payload sets simultaneously. 
    - Cluster Bomb - use multiple payload sets (one per position selected) and iterate through all combinations of the payload lists we provide. 
  - Repeater - Allows us to 'repeat' requests that have previously been made with or without modification. Often used in a precursor step to fuzzing with the aforementioned Intruder
  - Sequencer - Analyzes the 'randomness' present in parts of the web app which are intended to be unpredictable. This is commonly used for testing session cookies
  - Decoder - As the name suggests, Decoder is a tool that allows us to perform various transforms on pieces of data. These transforms vary from decoding/encoding to various bases or URL encoding.
  - Comparer - Comparer as you might have guessed is a tool we can use to compare different responses or other pieces of data such as site maps or proxy histories (awesome for access control issue testing). This is very similar to the Linux tool diff.
  - Extender - Similar to adding mods to a game like Minecraft, Extender allows us to add components such as tool integrations, additional scan definitions, and more!
  - Scanner - Automated web vulnerability scanner that can highlight areas of the application for further manual investigation or possible exploitation with another section of Burp. This feature, while not in the community edition of Burp Suite, is still a key facet of performing a web application test.

#### Metasploit

- initilizing: `msfdb init && msfconsole` 
- check database status: `db_status`
- help menu: `help`
- common modules:
![Metasploit Framework](/assets/metasploit_framework.png)
- use the buil-in nmap and send the results directly to database: `db_namp -sV [ip address]`
- what to run to load mimikatz: `load kiwi`
  - more explanation: https://www.hackers-arise.com/post/2018/11/26/metasploit-basics-part-21-post-exploitation-with-mimikatz


#### Nessus

- Common scans:
  - Host Discovery: a simple scan to discover live hosts
  - Basic Network Scan: full system scan suitable for any host

![nessus](/assets/Nessus.png)

  - Credentialed Patch Audit: Authenticate to hosts and enumerate missing updates
  - Web Application Tests: specifically used for scanning Web Applications
  
![nessus-web](/assets/Nessus-web.png)


#### Hydra

- brute force FTP: `hydra -l <username> -P <full path to pass> ftp://<ip address>`
- brute force SSH: `hydra -l <username> -P <full path to pass> <ip address> -t 4 ssh`
  - `-t`: specifies the number of threads to use
- post web form:`hydra -l <username> -P <wordlist> <ip address> http-post-form "/:username=^USER^&password=^PASS^:F=incorrect" -V`
  - http-post-form: indicates the ype of form (post)
  - /login url: the login page url
  - F=incorrect: if this word appears on the page, it's incorrect
  - username=^USER^&password=^PASS^: depending the web form, can be found in Inspect Element's Network section

![hydra](/assets/Hydra.png)